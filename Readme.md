# PythonMeetup Bot - Чат-бот для IT-мероприятий

PythonMeetup Bot - это Telegram-бот для организации и проведения IT-мероприятий (митапов). Бот решает проблемы общения между спикерами и участниками, предоставляет инструменты для нетворкинга, управления программой мероприятий и монетизации.

**Основная идея:** Перенести общение на IT-мероприятиях в привычный для разработчиков формат - чат, чтобы преодолеть стеснение участников и повысить вовлеченность.

### Основные функции

**Для участников (гостей):**

- *Программа мероприятий* - просмотр расписания докладов
- *Вопросы спикерам* - возможность задать вопросы во время выступления
- *Знакомства* - система нетворкинга для поиска собеседников по интересам
- *Донаты* - поддержка мероприятия через встроенные платежи Telegram
- *Подписка* - уведомления о будущих мероприятиях
- *Заявка спикером* - подача заявки на выступление

**Для спикеров:**

- *Управление выступлениями* - начало/завершение докладов
- *Ответы на вопросы* - просмотр и ответы на вопросы от участников
- *Режим слушателя* - возможность участвовать как обычный участник
- *Мои заявки* - управление своими заявками на выступление
- *Мои вопросы* - вопросы к вашим выступлениям

**Для организаторов:**

- *Админ-панель* - управление мероприятиями, спикерами, рассылками
- *Массовые уведомления* - рассылка сообщений участникам
- *Статистика* - просмотр донатов, активности пользователей
- *Автоматические напоминания* - уведомления о мероприятиях
- *Управление знакомствами* - модерация анкет и взаимодействий

## Архитектура проекта

Проект построен на стеке:
- Python 3.13
- Django 5.2.8
- aiogram 3.22.0
- environs[django] 14.5.0 — для чтения .env
- SQLite по умолчанию

```text
├── app_core/                                      # Основное приложение Django
│   ├── bot/                                       # Логика Telegram-бота
│   │   ├── handlers/                              # Обработчики команд
│   │   │   ├── donations.py                       # Донаты и платежи
│   │   │   ├── help.py                            # Помощь по боту
│   │   │   ├── networking.py                      # Система знакомств
│   │   │   ├── program.py                         # Программа мероприятий
│   │   │   ├── questions.py                       # Вопросы спикерам
│   │   │   ├── speaker_application.py             # Подача заявок спикером
│   │   │   └── start.py                           # Стартовые команды и меню
│   │   │   └── subscription.py                    # Управление подпиской
│   │   │   ├── speaker/                           # Функционал для спикеров
│   │   │       ├── applications.py                # Управление заявками
│   │   │       ├── mode_switch.py                 # Переключение между режимами спикера/слушателя
│   │   │       ├── presentation.py                # Управление выступлениями
│   │   │       ├── questions.py                   # Ответы на вопросы (отдельный модуль для спикеров)
│   │   ├── keyboards/                             # Клавиатуры бота
│   │   ├── middlewares/                           # ORM интеграция
│   │   ├── services/                              # Сервисные функции
│   │   │   ├── scheduler.py                       # Планировщик уведомлений
│   │   │   ├── admin_notification_service.py      # Сервис рассылки из админки
│   │   │   ├── notification_service.py            # Уведомления
│   │   │   └── event_service.py                   # Сервис мероприятий
│   │   ├── states/                                # Состояния FSM
│   │   └── bot_main.py                            # Основной файл запуска бота
│   ├── management/commands/                       # Django команды
│   │   ├── generate_events.py                     # Генерация тестовых данных
│   │   ├── generate_networking_profiles.py        # Генерация анкет
│   │   └── runbot.py                              # Запуск бота
│   ├── migrations/                                # Миграции базы данных
│   ├── models.py                                  # Модели Django
│   ├── admin.py                                   # Админ-панель
│   └── apps.py                                    # Конфигурация приложения
├── pythonmeetup_service/                          # Настройки проекта Django
│   ├── settings.py                                # Настройки
│   ├── urls.py                                    # URL маршруты
│   ├── wsgi.py                                    # WSGI конфигурация
│   └── asgi.py                                    # ASGI конфигурация
├── manage.py                                      # Django management
├── requirements.txt                               # Зависимости
├── .env                                           # Пример переменных окружения
└── db.sqlite3                                     # База данных SQLite (создается автоматически)
```

## Установка и запуск

1. Клонируйте репозиторий

2. Настройка виртуального окружения

```bash
python -m venv venv
```

```bash
# Активация виртуального окружения
# Windows:
venv\Scripts\activate
# Linux/Mac:
source venv/bin/activate
```

3. Установка зависимостей

```bash
pip install -r requirements.txt
```

4. Настройка переменных окружения

Создайте файл `.env` в корне проекта

```env
# Django
DJANGO_SECRET_KEY=ваш_секретный_ключ
DJANGO_DEBUG=True
DJANGO_ALLOWED_HOSTS=localhost,127.0.0.1
DJANGO_LANGUAGE_CODE=ru
DJANGO_TIME_ZONE=Europe/Moscow

# Telegram Bot
TELEGRAM_BOT_TOKEN=ваш_токен_бота
TELEGRAM_PAYMENTS_PROVIDER_TOKEN=ваш_токен_платежей
```

`DJANGO_SECRET_KEY` - Секретный ключ Django - используется для криптографической подписи. Должен быть уникальным и непредсказуемым значением. В продакшене никогда не используйте дефолтные значения. [Документация](https://docs.djangoproject.com/en/5.2/ref/settings/#secret-key)

`DJANGO_DEBUG` - Режим отладки - булево значение (True/False). Включает детальные страницы ошибок с информацией о настройках и среде выполнения. Никогда не включайте в продакшене! [Документация](https://docs.djangoproject.com/en/5.2/ref/settings/#debug)

`DJANGO_ALLOWED_HOSTS` - Разрешенные хосты - список доменов/хостов, которые может обслуживать Django. Защита от HTTP Host header атак. При DEBUG=True проверка отключается. [Документация](https://docs.djangoproject.com/en/5.2/ref/settings/#allowed-hosts)

5. Настройка базы данных

```bash
# Применение миграций
python manage.py migrate

# Создание суперпользователя для админ-панели
python manage.py createsuperuser

# Генерация тестовых данных (опционально)
python manage.py generate_events
python manage.py generate_networking_profiles
```

6. Запуск

**Запуск Django сервера (админ-панель):**

```bash
python manage.py runserver
```

Админ-панель доступна по адресу: http://localhost:8000/admin

**Запуск Telegram-бота:**

```bash
python manage.py runbot
```

## Интеграция платежей

Бот использует встроенную систему платежей Telegram. Для настройки:

- Создайте бота через [@BotFather](https://t.me/BotFather)
- Включите платежи: `/mybots` → выберите бота → `Bot Settings` → `Payments`
- Настройте провайдера платежей
- Получите `TELEGRAM_PAYMENTS_PROVIDER_TOKEN`
- Добавьте токен в `.env`

**Тестирование платежей:**

- В режиме разработки платежи проходят через тестовую систему
- Деньги не списываются реально
- Все транзакции записываются в базу данных

## Модели данных

- **User** - Пользователи (гости, спикеры, организаторы)
- **Event** - Мероприятия
- **Talk** - Доклады (привязаны к мероприятиям и спикерам)
- **Question** - Вопросы от участников к спикерам
- **Donation** - Донаты от участников
- **SpeakerApplication** - Заявки на выступление
- **NetworkingProfile** - Анкеты для знакомств
- **NetworkingInteraction** - Взаимодействия в системе знакомств
- **MassNotification** - Массовые рассылки


### Цель проекта

Код написан в образовательных целях на онлайн-курсе для веб-разработчиков [dvmn.org](https://dvmn.org/).
